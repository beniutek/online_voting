<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>OnlineVoting::Crypto::BlindSigner</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../../css/github.css" type="text/css" media="screen" />
<script src="../../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>


    <meta property="og:title" value="OnlineVoting::Crypto::BlindSigner">

  

    <meta name="keywords" content="OnlineVoting::Crypto::BlindSigner class">
  
    <meta name="keywords" content="sign, blind_sign, verify, blind, blinding_factor, text_to_int, int_to_text, unblind, _sign, _verify">
  
</head>

<body>
    <div class="banner">
        
        <h1>
            <span class="type">Class</span>
            OnlineVoting::Crypto::BlindSigner
            
                <span class="parent">&lt;
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../../files/online_voting/crypto/blind_signer_rb.html">online_voting/crypto/blind_signer.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-_sign">_sign</a>,
              </li>
            
              
              <li>
                <a href="#method-i-_verify">_verify</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-blind">blind</a>,
              </li>
            
              
              <li>
                <a href="#method-i-blind_sign">blind_sign</a>,
              </li>
            
              
              <li>
                <a href="#method-i-blinding_factor">blinding_factor</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-int_to_text">int_to_text</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-sign">sign</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-text_to_int">text_to_int</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-unblind">unblind</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>V</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-verify">verify</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
    
    
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-_sign">
            
              <b>_sign</b>(msg, key)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-_sign" name="method-i-_sign" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-_sign_source')" id="l_method-i-_sign_source">show</a>
                
              </p>
              <div id="method-i-_sign_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_sign</span>(<span class="ruby-identifier">msg</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-comment"># sm = m^d (mod n)</span>
  <span class="ruby-identifier">msg</span>.<span class="ruby-identifier">to_bn</span>.<span class="ruby-identifier">mod_exp</span>(<span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;d&#39;</span>], <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]) <span class="ruby-operator">%</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-_verify">
            
              <b>_verify</b>(msg_signed, msg, key)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-_verify" name="method-i-_verify" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-_verify_source')" id="l_method-i-_verify_source">show</a>
                
              </p>
              <div id="method-i-_verify_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_verify</span>(<span class="ruby-identifier">msg_signed</span>, <span class="ruby-identifier">msg</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-comment"># sm&#39;^e (mod n) == m&#39;</span>
  <span class="ruby-identifier">verify_res</span> = <span class="ruby-identifier">msg_signed</span>.<span class="ruby-identifier">to_bn</span>.<span class="ruby-identifier">mod_exp</span>(<span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;e&#39;</span>], <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]) <span class="ruby-operator">%</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]
  <span class="ruby-identifier">matches</span> = <span class="ruby-identifier">verify_res</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">msg</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-blind">
            
              <b>blind</b>(msg, key)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-blind" name="method-i-blind" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-blind_source')" id="l_method-i-blind_source">show</a>
                
              </p>
              <div id="method-i-blind_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 28</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">blind</span>(<span class="ruby-identifier">msg</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">blinding_factor</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">msg_int</span> = <span class="ruby-identifier">text_to_int</span>(<span class="ruby-identifier">msg</span>)
  <span class="ruby-comment"># m&#39; = mr^e (mod n)</span>
  <span class="ruby-identifier">msg_int_blinded</span> = <span class="ruby-identifier">msg_int</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_bn</span>.<span class="ruby-identifier">mod_exp</span>(<span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;e&#39;</span>], <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]) <span class="ruby-operator">%</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">msg_int_blinded</span>, <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-blind_sign">
            
              <b>blind_sign</b>(message:, key:)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-blind_sign" name="method-i-blind_sign" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-blind_sign_source')" id="l_method-i-blind_sign_source">show</a>
                
              </p>
              <div id="method-i-blind_sign_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">blind_sign</span>(<span class="ruby-value">message:</span>, <span class="ruby-value">key:</span>)
  <span class="ruby-identifier">digest</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA224</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-identifier">message</span>)

  <span class="ruby-comment"># m&#39; = mr^e (mod n)</span>
  <span class="ruby-identifier">msg_int_blinded</span>, <span class="ruby-identifier">r</span> = <span class="ruby-identifier">blind</span>(<span class="ruby-identifier">digest</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">msg_int_blinded_signed</span> = <span class="ruby-identifier">_sign</span>(<span class="ruby-identifier">msg_int_blinded</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">msg_int</span> = <span class="ruby-identifier">text_to_int</span>(<span class="ruby-identifier">digest</span>)
  <span class="ruby-identifier">msg_int_signed</span> = <span class="ruby-identifier">_sign</span>(<span class="ruby-identifier">msg_int</span>, <span class="ruby-identifier">key</span>)

  [
    <span class="ruby-identifier">msg_int_blinded</span>,
    <span class="ruby-identifier">msg_int_blinded_signed</span>,
    <span class="ruby-identifier">r</span>
  ]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-blinding_factor">
            
              <b>blinding_factor</b>(key)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-blinding_factor" name="method-i-blinding_factor" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-blinding_factor_source')" id="l_method-i-blinding_factor_source">show</a>
                
              </p>
              <div id="method-i-blinding_factor_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">blinding_factor</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">n</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>].<span class="ruby-identifier">to_i</span>
  <span class="ruby-identifier">r</span> = (<span class="ruby-identifier">rand</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">n</span><span class="ruby-value">-1</span>)).<span class="ruby-identifier">to_i</span>
  <span class="ruby-comment"># greatest common divisor</span>
  <span class="ruby-identifier">r</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">while</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">gcd</span>(<span class="ruby-identifier">n</span>) <span class="ruby-operator">!=</span><span class="ruby-value">1</span>
  <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-int_to_text">
            
              <b>int_to_text</b>(int)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-int_to_text" name="method-i-int_to_text" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-int_to_text_source')" id="l_method-i-int_to_text_source">show</a>
                
              </p>
              <div id="method-i-int_to_text_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 49</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">int_to_text</span>(<span class="ruby-identifier">int</span>)
  <span class="ruby-identifier">bitmap</span> = <span class="ruby-identifier">int</span>.<span class="ruby-identifier">to_i</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value">2</span>)
  [<span class="ruby-identifier">bitmap</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/^1/</span>, <span class="ruby-string">&#39;&#39;</span>)].<span class="ruby-identifier">pack</span>(<span class="ruby-string">&#39;B*&#39;</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sign">
            
              <b>sign</b>(message:, key:)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-sign" name="method-i-sign" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-sign_source')" id="l_method-i-sign_source">show</a>
                
              </p>
              <div id="method-i-sign_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 4</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sign</span>(<span class="ruby-value">message:</span>, <span class="ruby-value">key:</span>)
  <span class="ruby-identifier">_sign</span>(<span class="ruby-identifier">message</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-text_to_int">
            
              <b>text_to_int</b>(text)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-text_to_int" name="method-i-text_to_int" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-text_to_int_source')" id="l_method-i-text_to_int_source">show</a>
                
              </p>
              <div id="method-i-text_to_int_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">text_to_int</span>(<span class="ruby-identifier">text</span>)
  <span class="ruby-identifier">bitmap</span> = <span class="ruby-string">&#39;1&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">text</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;B*&#39;</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-identifier">bitmap</span>.<span class="ruby-identifier">to_i</span>(<span class="ruby-value">2</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-unblind">
            
              <b>unblind</b>(blinded_msg, r, key)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-unblind" name="method-i-unblind" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-unblind_source')" id="l_method-i-unblind_source">show</a>
                
              </p>
              <div id="method-i-unblind_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unblind</span>(<span class="ruby-identifier">blinded_msg</span>, <span class="ruby-identifier">r</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-comment"># sm = sm&#39; * r^-1 (mod n)</span>
  <span class="ruby-identifier">msg</span> = <span class="ruby-identifier">blinded_msg</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_bn</span>.<span class="ruby-identifier">mod_inverse</span>(<span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]) <span class="ruby-operator">%</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">params</span>[<span class="ruby-string">&#39;n&#39;</span>]
  <span class="ruby-identifier">msg</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-verify">
            
              <b>verify</b>(signed:, message:, key:)
            
            <a href="../../../classes/OnlineVoting/Crypto/BlindSigner.html#method-i-verify" name="method-i-verify" class="permalink">Link</a>
          </div>

          
            <div class="description">
              
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-verify_source')" id="l_method-i-verify_source">show</a>
                
              </p>
              <div id="method-i-verify_source" class="dyn-source">
                <pre><span class="ruby-comment"># File online_voting/crypto/blind_signer.rb, line 24</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify</span>(<span class="ruby-value">signed:</span>, <span class="ruby-value">message:</span>, <span class="ruby-value">key:</span>)
  <span class="ruby-identifier">_verify</span>(<span class="ruby-identifier">signed</span>, <span class="ruby-identifier">message</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
      
    
  
</div>

    </div>
  </body>
</html>
